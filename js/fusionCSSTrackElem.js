/**
 * JavaScript to track elements and optionally stick elements, works with jQuery or fusionLib.
 *
 * THIS SOFTWARE IS PROVIDED "AS IS" AND WITHOUT ANY EXPRESS OR IMPLIED
 * WARRANTIES, INCLUDING, WITHOUT LIMITATION, THE IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.
 *
 * @package fusionCSS
 * @copyright Copyright (c) 2018 - 2019 fusionCSS. All rights reserved.
 * @link http://fusionCSS.com
 */
!function(){var e=[],t=$(window).scrollTop(),s=[];function o(s,o){t>=e[s].top&&e[s].before?(e[s].before=!1,e[s].handler.call(e[s].element,o,e[s]),e[s].element.trigger("pointReached",[o])):t<e[s].top&&!e[s].before&&(e[s].before=!0,e[s].handler.call(e[s].element,o,e[s]),e[s].element.trigger("pointReached",[o]))}function i(e){var t=e.offset;if(e.stoppedBy){var s=e.stoppedBy;do{t+=s.outerHeight(!0),s=s[0]._stickyOpts?s[0]._stickyOpts.stoppedBy:null}while(s)}return t}$.fn.extend({trackPoint:function(s){var i=(s=s||{}).offset?s.offset:0,n=s.handler?s.handler:function(){},r=s.onBeforeResize?s.onBeforeResize:function(){},a=s.onAfterResize?s.onAfterResize:function(){},f="string"==typeof i&&i.match(/%$/)?"%":"px";return this.each((function(){var s=$(this),l="%"==f?parseInt(i)/100*$(window).height():parseInt(i),c={element:s,top:s.offset().top-l,before:!0,offset:i,offsetPixels:l,handler:n,onBeforeResize:r,onAfterResize:a};e.push(c),s.wrap('<div class="trackPointWrapper"></div>'),t>=c.top&&o(e.length-1,"down"),e.sort((function(e,t){return t.top-e.top}))}))},trackPointSetOffset:function(t){var s="string"==typeof t&&t.match(/%$/)?"%":"px";return this.each((function(){for(var i=0;i<e.length;i++)if(this===e[i].element[0]){var n=e[i].top,r="%"==s?parseInt(t)/100*$(window).height():parseInt(t);e[i].top=e[i].element.offset().top-r,e[i].offset=t,e[i].offsetPixels=r,n!=e[i].top&&o(i,e[i].top>n?"up":"down");break}}))}}),$(window).on("scroll",(function(){var s=$(window).scrollTop(),i=s>t?"down":"up";if(s!=t){t=s;for(var n=0;n<e.length;n++)o(n,i)}})).on("resize",(function(){for(var t=0;t<e.length;t++){e[t].onBeforeResize.call(e[t].element,e[t]);var s=e[t].top,i="%"==("string"==typeof e[t].offset&&e[t].offset.match(/%$/)?"%":"px")?parseInt(e[t].offset)/100*$(window).height():parseInt(e[t].offset);e[t].top=e[t].element.offset().top-i,e[t].offsetPixels=i,s!=e[t].top&&o(t,e[t].top>s?"up":"down"),e[t].onAfterResize.call(e[t].element,e[t])}})),$.fn.extend({stickyOnScroll:function(e){return(e=e||{}).stuckClass=e.stuckClass?e.stuckClass:"stuck",e.handler=e.handler?e.handler:function(){},e.offset=e.offset?e.offset:0,e.stuck=!1,e.stoppedBy=e.stoppedBy?e.stoppedBy:null,e.releasedBy=e.releasedBy?e.releasedBy:null,e.releasedByEdge=e.releasedByEdge?e.releasedByEdge:"bottom",e.released=!1,e.setTop=void 0===e.setTop||e.setTop,this.each((function(){var t=$(this);t[0]._stickyOpts=e,t.trackPoint({handler:function(e,t){var s=this[0]._stickyOpts;"down"==e?(s.stuck=!0,this.parent().height(this.outerHeight(!0)),this.addClass(s.stuckClass),s.setTop&&this.css("top",t.offsetPixels+"px"),s.handler.call(this,"stuck"),this.trigger("stuck"),s.releasedBy&&s.releasedBy.trackPointSetOffset(-("top"===s.releasedByEdge?0:s.releasedBy.outerHeight(!1))+(this.position().top+this.outerHeight(!1)))):"up"==e&&(s.stuck=!1,this.parent().height(""),this.removeClass(s.stuckClass),s.handler.call(this,"unstuck"),this.trigger("unstuck"))},onBeforeResize:function(){this[0]._stickyOpts.stuck&&(this.parent().height(""),this.removeClass(e.stuckClass)),this.trackPointSetOffset(i(this[0]._stickyOpts))},onAfterResize:function(t){this[0]._stickyOpts.stuck&&(this.parent().height(this.outerHeight(!0)),this.addClass(e.stuckClass).css("top",t.offsetPixels+"px"),e.releasedBy&&e.releasedBy.trackPointSetOffset(-("top"===e.releasedByEdge?0:e.releasedBy.outerHeight(!1))+(this.position().top+this.outerHeight(!1))))},offset:i(e)}),e.releasedBy&&e.releasedBy.trackPoint({handler:function(e,s){var o=t[0]._stickyOpts;o.stuck&&("up"==e?(t.addClass(o.stuckClass),o.released=!1):"down"==e&&(t.removeClass(o.stuckClass),o.released=!0))},onBeforeResize:function(){t[0]._stickyOpts.released&&t[0]._stickyOpts.stuck&&t.add(e.stuckClass)},onAfterResize:function(s){t[0]._stickyOpts.released&&t[0]._stickyOpts.stuck&&t.removeClass(e.stuckClass)},offset:-("top"===e.releasedByEdge?0:e.releasedBy.outerHeight(!1))+(t.position().top+t.outerHeight(!1))}),t.parent().addClass("stickyWrapper"),s.push(t)}))},stickyOnScrollOffset:function(e){return this.each((function(){this._stickyOpts.offset=e,$(this).trackPointSetOffset(i(this._stickyOpts))}))}})}();
//# sourceMappingURL=fusionCSSTrackElem.js.map
