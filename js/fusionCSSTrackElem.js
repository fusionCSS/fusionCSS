(function(){var tracked=[],lastScroll=$(window).scrollTop(),stickyList=[];function testTrigger(idx,direction){if(lastScroll>=tracked[idx].top&&tracked[idx].before){tracked[idx].before=false;tracked[idx].handler.call(tracked[idx].element,direction,tracked[idx]);tracked[idx].element.trigger("pointReached",[direction])}else if(lastScroll<tracked[idx].top&&!tracked[idx].before){tracked[idx].before=true;tracked[idx].handler.call(tracked[idx].element,direction,tracked[idx]);tracked[idx].element.trigger("pointReached",[direction])}}$.fn.extend({trackPoint:function(opts){opts=opts?opts:{};var offset=opts.offset?opts.offset:0,handler=opts.handler?opts.handler:function(){},onBeforeResize=opts.onBeforeResize?opts.onBeforeResize:function(){},onAfterResize=opts.onAfterResize?opts.onAfterResize:function(){},offsetType=typeof offset==="string"&&offset.match(/%$/)?"%":"px";return this.each(function(){var el=$(this),offsetPixels=offsetType=="%"?parseInt(offset)/100*$(window).height():parseInt(offset),d={element:el,top:el.offset().top-offsetPixels,before:true,offset:offset,offsetPixels:offsetPixels,handler:handler,onBeforeResize:onBeforeResize,onAfterResize:onAfterResize};tracked.push(d);el.wrap('<div class="trackPointWrapper"></div>');if(lastScroll>=d.top)testTrigger(tracked.length-1,"down");tracked.sort(function(a,b){return b.top-a.top})})},trackPointSetOffset:function(offset){var offsetType=typeof offset==="string"&&offset.match(/%$/)?"%":"px";return this.each(function(){for(var i=0;i<tracked.length;i++){if(this===tracked[i].element[0]){var oldTop=tracked[i].top,offsetPixels=offsetType=="%"?parseInt(offset)/100*$(window).height():parseInt(offset);tracked[i].top=tracked[i].element.offset().top-offsetPixels;tracked[i].offset=offset;tracked[i].offsetPixels=offsetPixels;if(oldTop!=tracked[i].top){testTrigger(i,tracked[i].top>oldTop?"up":"down")}break}}})}});$(window).on("scroll",function(){var top=$(window).scrollTop(),direction=top>lastScroll?"down":"up";if(top!=lastScroll){lastScroll=top;for(var i=0;i<tracked.length;i++){testTrigger(i,direction)}}}).on("resize",function(){for(var i=0;i<tracked.length;i++){tracked[i].onBeforeResize.call(tracked[i].element,tracked[i]);var oldTop=tracked[i].top,offsetType=typeof tracked[i].offset==="string"&&tracked[i].offset.match(/%$/)?"%":"px",offsetPixels=offsetType=="%"?parseInt(tracked[i].offset)/100*$(window).height():parseInt(tracked[i].offset);tracked[i].top=tracked[i].element.offset().top-offsetPixels;tracked[i].offsetPixels=offsetPixels;if(oldTop!=tracked[i].top){testTrigger(i,tracked[i].top>oldTop?"up":"down")}tracked[i].onAfterResize.call(tracked[i].element,tracked[i])}});function _calcOffset(opts){var offset=opts.offset;if(opts.stoppedBy){var el=opts.stoppedBy;do{offset+=el.outerHeight(true);el=el[0]._stickyOpts?el[0]._stickyOpts.stoppedBy:null}while(el)}return offset}$.fn.extend({stickyOnScroll:function(opts){opts=opts?opts:{};opts.stuckClass=opts.stuckClass?opts.stuckClass:"stuck";opts.handler=opts.handler?opts.handler:function(){};opts.offset=opts.offset?opts.offset:0;opts.stuck=false;opts.stoppedBy=opts.stoppedBy?opts.stoppedBy:null;opts.releasedBy=opts.releasedBy?opts.releasedBy:null;opts.releasedByEdge=opts.releasedByEdge?opts.releasedByEdge:"bottom";opts.released=false;opts.setTop=typeof opts.setTop!=="undefined"?opts.setTop:true;return this.each(function(){var el=$(this);el[0]._stickyOpts=opts;el.trackPoint({handler:function(direction,trackData){var opts=this[0]._stickyOpts;if(direction=="down"){opts.stuck=true;this.parent().height(this.outerHeight(true));this.addClass(opts.stuckClass);if(opts.setTop)this.css("top",trackData.offsetPixels+"px");opts.handler.call(this,"stuck");this.trigger("stuck");if(opts.releasedBy){opts.releasedBy.trackPointSetOffset(-(opts.releasedByEdge==="top"?0:opts.releasedBy.outerHeight(false))+(this.position().top+this.outerHeight(false)))}}else if(direction=="up"){opts.stuck=false;this.parent().height("");this.removeClass(opts.stuckClass);opts.handler.call(this,"unstuck");this.trigger("unstuck")}},onBeforeResize:function(){if(this[0]._stickyOpts.stuck){this.parent().height("");this.removeClass(opts.stuckClass)}this.trackPointSetOffset(_calcOffset(this[0]._stickyOpts))},onAfterResize:function(trackData){if(this[0]._stickyOpts.stuck){this.parent().height(this.outerHeight(true));this.addClass(opts.stuckClass).css("top",trackData.offsetPixels+"px");if(opts.releasedBy){opts.releasedBy.trackPointSetOffset(-(opts.releasedByEdge==="top"?0:opts.releasedBy.outerHeight(false))+(this.position().top+this.outerHeight(false)))}}},offset:_calcOffset(opts)});if(opts.releasedBy){opts.releasedBy.trackPoint({handler:function(direction,trackData){var opts=el[0]._stickyOpts;if(opts.stuck){if(direction=="up"){el.addClass(opts.stuckClass);opts.released=false}else if(direction=="down"){el.removeClass(opts.stuckClass);opts.released=true}}},onBeforeResize:function(){if(el[0]._stickyOpts.released&&el[0]._stickyOpts.stuck)el.add(opts.stuckClass)},onAfterResize:function(trackData){if(el[0]._stickyOpts.released&&el[0]._stickyOpts.stuck)el.removeClass(opts.stuckClass)},offset:-(opts.releasedByEdge==="top"?0:opts.releasedBy.outerHeight(false))+(el.position().top+el.outerHeight(false))})}el.parent().addClass("stickyWrapper");stickyList.push(el)})},stickyOnScrollOffset:function(offset){return this.each(function(){this._stickyOpts.offset=offset;$(this).trackPointSetOffset(_calcOffset(this._stickyOpts))})}})})();