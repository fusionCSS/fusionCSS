$.fn.extend({makeDragContainer:function(e){return(e=e||{}).dragMarkerClass=e.dragMarkerClass||"dragMarker",e.dragItemClass=e.dragItemClass||"dragItem",e.dragDraggingClass=e.dragDraggingClass||"dragDragging",e.disableDragInto=e.disableDragInto||!1,e.dragTopOnly=e.dragTopOnly||!1,this.each((function(){var t,o,a,r,n,s=$(this),l=null,g=0,i=0,d=null,c=null,f=null,p=null,u=!1;if(s.find("."+e.dragMarkerClass).length||s.append('<div class="'+e.dragMarkerClass+'" style="display: none;"></div>'),e.dragTopOnly){var h=s.find("ul");h.length||(h=s.find("ol")),h.first().children().addClass(e.dragItemClass)}else s.find("li").addClass(e.dragItemClass);function v(r){var n=$(r.target),f=n.closest("."+e.dragItemClass),p=s.offset();if(!n.closest("a").length&&f.length){r.touches&&r.touches.length?(o=r.touches[0].pageX,a=r.touches[0].pageY):(o=r.pageX,a=r.pageY),g=o-f.offset().left,i=a-f.offset().top,o-=p.left,a-=p.top,u&&(o+=s.scrollLeft(),a+=s.scrollTop());var h={dragging:f,eventTarget:n,allowDrag:!0};s.trigger("draggingStart",h),h.allowDrag&&(r.preventDefault(),(l=f).addClass(e.dragDraggingClass),d=c=null,t=s.find("."+e.dragMarkerClass),e.copyFunction?e.copyFunction(t,l):t.html(l.html()),t.css("left",o-g+"px").css("top",a-i+"px").width(l.outerWidth(!0)),s.on("mousemove",D).on("touchmove",D).on("mouseup",y).on("touchend",y))}}function m(){p.scrollTop(p.scrollTop()+r),D(n)}function C(e,t){t?(f&&e[0]!=p[0]&&w(),p=e,r=2*t,null===f&&(f=window.setInterval(m,15))):f&&w()}function w(){null!==f&&(window.clearInterval(f),f=null)}function D(r){var f,p,h,v,m=s.offset(),D=s[0].getBoundingClientRect();if(r.preventDefault(),r.stopPropagation(),n=r,r.touches&&r.touches.length?(f=r.touches[0].pageX,p=r.touches[0].pageY,h=r.touches[0].clientX,v=r.touches[0].clientY):(f=r.pageX,p=r.pageY,h=r.clientX,v=r.clientY),f-=m.left,p-=m.top,u&&(f+=s.scrollLeft(),p+=s.scrollTop()),h<=Math.ceil(D.left+2)||h>=Math.floor(D.right-2)||v<=Math.ceil(D.top+2)||v>=Math.floor(D.bottom-2))y(r);else{t.css("left",f-g+"px").css("top",p-i+"px"),t.hide();var b=document.elementFromPoint(h,v);if((b=$(b).closest("."+e.dragItemClass)).length&&!b.hasClass(e.dragDraggingClass)&&!b.closest("."+e.dragDraggingClass).length){var I=Math.abs(o-f),M=Math.abs(a-p),O=b[0].getBoundingClientRect(),P=!0;(e.disableDragInto||e.disableDropOn&&"true"===b.attr(e.disableDropOn))&&(P=!1);var T={dragging:l,dropTarget:b,dropPosition:"on",allowPosition:!0};if(I>M){var k=P?O.width/3:O.width/2;h>O.right-k?(l.css("opacity",1),c="after",b.next()[0]!==l[0]&&(s.trigger("draggingOver",T),T.allowPosition&&(l.remove(),l.insertAfter(b),o=f,a=p,d=b))):h<O.left+k?(l.css("opacity",1),c="before",b.prev()[0]!==l[0]&&(s.trigger("draggingOver",T),T.allowPosition&&(l.remove(),l.insertBefore(b),o=f,a=p,d=b))):!P||b[0]===l[0]&&"on"===c||(s.trigger("draggingOver",T),T.allowPosition&&(c="on",l.css("opacity",.2),d=b))}else{var x=P?O.height/3:O.height/2;v>O.bottom-x?(l.css("opacity",1),c="after",b.next()[0]!==l[0]&&(s.trigger("draggingOver",T),T.allowPosition&&(l.remove(),l.insertAfter(b),o=f,a=p,d=b))):v<O.top+x?(l.css("opacity",1),c="before",b.prev()[0]!==l[0]&&(s.trigger("draggingOver",T),T.allowPosition&&(l.remove(),l.insertBefore(b),o=f,a=p,d=b))):!P||b[0]===l[0]&&"on"===c||(s.trigger("draggingOver",T),T.allowPosition&&(c="on",l.css("opacity",.2),d=b))}}t.show(),(D.top<0||D.bottom>$(window).height())&&(v<30||v>$(window).height()-30)?C($(window),v<30?-1:1):v<D.top+30?C(s,-1):v>D.bottom-30?C(s,1):w()}}function y(o){if(l){l.css("opacity",1),o.preventDefault(),s.off("mousemove",D).off("touchmove",D).off("mouseup",y).off("touchend",y),w(),t.hide(),l.removeClass(e.dragDraggingClass);var a={dragging:l,dropTarget:null===c?null:d,dropPosition:c};l=null,s.trigger("draggingEnd",a)}}s.find("li").parent().parent()[0]===s[0]&&(u=!0),s.on("mousedown",v).on("touchstart",v),$(document).on("keyup",(function(e){l&&"Escape"===e.key&&(y(e),e.preventDefault())}))}))}});
//# sourceMappingURL=fusionCSSDragOrder.js.map
